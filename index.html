<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SwiftCoin Pro</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

    <style>
        :root { 
            --bg: #f4f7f6; --text: #2d3436; --card: #ffffff; 
            --accent: #00b894; --danger: #ff7675; --overlay: rgba(255,255,255,0.8);
        }
        body.dark-theme { 
            --bg: #1e272e; --text: #f1f2f6; --card: #2f3542; --overlay: rgba(47, 53, 66, 0.9);
        }
        
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { 
            margin: 0; height: 100vh; color: var(--text); background: var(--bg); 
            background-size: cover; background-position: center; background-attachment: fixed;
        }

        /* SCREEN MANAGEMENT */
        .page { display: none; height: 100vh; flex-direction: column; position: absolute; width: 100%; top: 0; left: 0; }
        .page.active { display: flex; }
        .content-area { flex: 1; overflow-y: auto; padding: 20px; background: var(--overlay); }

        /* HEADER */
        .nav-header { padding: 15px 20px; background: var(--card); display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(0,0,0,0.1); }
        .title { font-weight: 800; font-size: 20px; }

        /* SETTINGS STYLING */
        .settings-group { background: var(--card); border-radius: 15px; margin-bottom: 20px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .settings-item { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .settings-item:last-child { border: 0; }
        .section-label { font-size: 12px; font-weight: 700; color: var(--accent); margin: 10px 0 5px 10px; text-transform: uppercase; }

        /* BUTTONS */
        .btn { padding: 10px 15px; border-radius: 10px; border: none; font-weight: 600; cursor: pointer; font-size: 14px; }
        .btn-outline { background: transparent; border: 1px solid var(--accent); color: var(--accent); }
        .btn-danger { background: rgba(255,118,117,0.1); color: var(--danger); }
        .add-fab { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; border-radius: 50%; background: var(--accent); color: white; border: none; font-size: 30px; box-shadow: 0 10px 20px rgba(0,184,148,0.3); }

        /* LIST ITEMS */
        .expense-card { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; }
    </style>
</head>
<body class="light-theme">

    <div id="mainPage" class="page active">
        <div class="nav-header">
            <span class="title">SwiftCoin</span>
            <span style="cursor:pointer" onclick="showPage('settingsPage')">‚öôÔ∏è Settings</span>
        </div>
        <div class="content-area" id="mainContent">
            <div id="history"></div>
        </div>
        <button class="add-fab" onclick="addExpense()">+</button>
    </div>

    <div id="settingsPage" class="page">
        <div class="nav-header">
            <span style="cursor:pointer" onclick="showPage('mainPage')">‚¨ÖÔ∏è Back</span>
            <span class="title">Settings</span>
            <span></span>
        </div>
        
        <div class="content-area">
            <div class="section-label">Appearance</div>
            <div class="settings-group">
                <div class="settings-item">
                    <span>Theme Mode</span>
                    <div>
                        <button class="btn btn-outline" onclick="setTheme('light-theme')">‚òÄÔ∏è</button>
                        <button class="btn btn-outline" onclick="setTheme('dark-theme')">üåô</button>
                    </div>
                </div>
                <div class="settings-item">
                    <span>Custom Background</span>
                    <input type="file" id="bgUpload" accept="image/*" style="display:none" onchange="uploadBG(event)">
                    <button class="btn btn-outline" onclick="document.getElementById('bgUpload').click()">üñºÔ∏è Upload</button>
                </div>
            </div>

            <div class="section-label">Export Data</div>
            <div class="settings-group">
                <div class="settings-item">
                    <span>Save Report</span>
                    <div>
                        <button class="btn btn-outline" onclick="exportPDF()">üìÑ PDF</button>
                        <button class="btn btn-outline" onclick="exportExcel()">üìä Excel</button>
                    </div>
                </div>
            </div>

            <div class="section-label">Data Management</div>
            <div class="settings-group">
                <div class="settings-item" onclick="cleanData('today')">
                    <span>Clear Today's Data</span>
                    <span style="color:var(--danger)">üóëÔ∏è</span>
                </div>
                <div class="settings-item" onclick="cleanData('week')">
                    <span>Clear Last 7 Days</span>
                    <span style="color:var(--danger)">üóëÔ∏è</span>
                </div>
                <div class="settings-item" onclick="cleanData('month')">
                    <span>Clear Last 30 Days</span>
                    <span style="color:var(--danger)">üóëÔ∏è</span>
                </div>
                <div class="settings-item" onclick="cleanData('all')" style="background: rgba(255,118,117,0.05);">
                    <span style="color:var(--danger); font-weight:700;">RESET EVERYTHING</span>
                    <span>üß®</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let allData = JSON.parse(localStorage.getItem('swiftCoinPro')) || {};

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        // --- APPEARANCE ---
        function setTheme(t) {
            document.body.className = t;
            localStorage.setItem('scTheme', t);
        }

        function uploadBG(e) {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = function(event) {
                document.body.style.backgroundImage = `url(${event.target.result})`;
                localStorage.setItem('scCustomBG', event.target.result);
            };
            reader.readAsDataURL(file);
        }

        // --- DATA CLEANING ---
        function cleanData(type) {
            if(!confirm(`Are you sure you want to delete ${type} data?`)) return;
            
            const now = new Date();
            if(type === 'all') {
                allData = {};
            } else {
                let limitDays = type === 'today' ? 0 : (type === 'week' ? 7 : 30);
                const cutoff = new Date();
                cutoff.setDate(now.getDate() - limitDays);
                
                Object.keys(allData).forEach(dateStr => {
                    if(new Date(dateStr) >= cutoff) delete allData[dateStr];
                });
            }
            saveAndRefresh();
        }

        // --- EXPORTS ---
        function exportExcel() {
            let csv = "Date,Item,Amount\n";
            Object.keys(allData).sort().forEach(date => {
                allData[date].items.forEach(i => {
                    csv += `${date},${i.where},${i.amt}\n`;
                });
            });
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('href', url);
            a.setAttribute('download', 'SwiftCoin_Report.csv');
            a.click();
        }

        function exportPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.text("SwiftCoin Expense Report", 14, 15);
            let rows = [];
            Object.keys(allData).sort().forEach(date => {
                allData[date].items.forEach(i => rows.push([date, i.where, i.amt]));
            });
            doc.autoTable({ head: [['Date', 'Description', 'Amount']], body: rows, startY: 25 });
            doc.save('SwiftCoin_Report.pdf');
        }

        // --- CORE LOGIC ---
        function saveAndRefresh() {
            localStorage.setItem('swiftCoinPro', JSON.stringify(allData));
            renderHistory();
        }

        function addExpense() {
            const w = prompt("What for?");
            const a = prompt("How much?");
            if(!w || !a) return;
            const today = new Date().toISOString().split('T')[0];
            if(!allData[today]) allData[today] = { items: [] };
            allData[today].items.unshift({ where: w, amt: a });
            saveAndRefresh();
        }

        function renderHistory() {
            const h = document.getElementById('history');
            h.innerHTML = "";
            Object.keys(allData).reverse().forEach(date => {
                allData[date].items.forEach(i => {
                    h.innerHTML += `<div class="expense-card">
                        <span><b>${i.where}</b><br><small>${date}</small></span>
                        <span style="color:var(--danger); font-weight:700;">‚Çπ${i.amt}</span>
                    </div>`;
                });
            });
        }

        // Load saved state
        window.onload = () => {
            const savedBG = localStorage.getItem('scCustomBG');
            if(savedBG) document.body.style.backgroundImage = `url(${savedBG})`;
            setTheme(localStorage.getItem('scTheme') || 'light-theme');
            renderHistory();
        };
    </script>
</body>
</html>
